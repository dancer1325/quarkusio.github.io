////
This guide is maintained in the main Quarkus repository
and pull requests should be submitted there:
https://github.com/quarkusio/quarkus/tree/main/docs/src/main/asciidoc
////
= Quarkus Extension Registry
include::_attributes.adoc[]
:categories: architecture
:summary: Learn more about the notion of extension registry and how you can use your own.
:topics: internals,extensions

* Quarkus dev tools
    ** allow
        *** ðŸ‘€listing and searching -- , via Quarkus extension registries, -- the Quarkus ecosystem extensionsðŸ‘€
    ** _Examples:_
        *** xref:cli-tooling.adoc[Quarkus CLI]
        *** xref:maven-tooling.adoc[Maven] plugin
        *** xref:gradle-tooling.adoc[Gradle] plugin
        *** https://code.quarkus.io[code.quarkus.io]

* Quarkus ecosystem extensions
    ** == xref:platform.adoc[Quarkus platform] extensions + https://github.com/quarkiverse[Quarkiverse Hub] extensions

* Quarkus extension registry
    ** == ðŸ’¡database / provide information aboutðŸ’¡
        *** available Quarkus platforms
        *** available non-platform extensions

[[registry.quarkus.io]]
== registry.quarkus.io

* == ðŸ‘€default Quarkus community extension registryðŸ‘€ /
    ** | EACH release of https://github.com/quarkusio/quarkus-platform[Quarkus community platform]
        *** updated
    ** == https://github.com/quarkiverse[Quarkiverse Hub]'s extensions
* https://registry.quarkus.io[Swagger UI]
    ** == ðŸ‘€Maven __snapshot__ repositoryðŸ‘€ /
        *** provides
            **** platform -- as -- Maven JSON artifacts
            **** extension catalogs -- as -- Maven JSON artifacts

=== Maven repository

* | download the extension catalogs,
    ** cached | user's local Maven repository
        *** == AVAILABLE WITHOUT Internet network
        *** REGULARLY (by default, *daily*) checked for updates

[[registry.quarkus.io.maven.repo]]
==== Maven repository configuration

* Quarkus dev tools
    ** ðŸ‘€come -- with -- this repository pre-configuredðŸ‘€
        *** | initialize Quarkus dev tools,
            **** AUTOMATICALLY added | Maven resolver

* Maven repository configuration
+
[source,xml]
----
<repository>
  <id>registry.quarkus.io</id>
  <name>Quarkus community extension registry</name>
  <url>https://registry.quarkus.io/maven</url>
  <snapshots>
    <enabled>true</enabled>
    <updatePolicy>daily</updatePolicy>
    <checksumPolicy>warn</checksumPolicy>
  </snapshots>
</repository>
----

==== Maven repository mirrors and proxies

When the Quarkus dev tools Maven resolver is initialized, the relevant Maven mirrors and proxies found in the user `settings.xml` are automatically applied to the <<registry.quarkus.io.maven.repo,registry.quarkus.io>> Maven repository configuration, as if the <<registry.quarkus.io.maven.repo,registry.quarkus.io>> Maven repository was configured in the user `settings.xml`.

That means, if, for example, a matching Maven repository mirror was applied to the <<registry.quarkus.io.maven.repo,registry.quarkus.io>> Maven repository, the <<registry.quarkus.io.maven.repo,registry.quarkus.io>> Maven repository would have to be added to the mirror repository group in the corresponding Maven server instance (e.g. Nexus).

==== Overriding the default registry Maven repository configuration

* | "settings.xml",
    ** add EXPLICITLY
+
[source,xml]
----
<repository>
  <id>registry.quarkus.io</id>
  <name>Quarkus community extension registry</name>
  <url>YourDesiredValue</url>
  <snapshots>
    <enabled>true</enabled>
    <updatePolicy>daily</updatePolicy>
    <checksumPolicy>warn</checksumPolicy>
  </snapshots>
</repository>
----

== Quarkus Extension Registry Client Configuration

Typically, Quarkus community users will not need to have any registry-related configuration in their environment. The registry hosted at <<registry.quarkus.io,registry.quarkus.io>> is enabled in all the Quarkus dev tools by default. However, there could be a few situations where a custom registry client configuration could help. For example, to change the local registry cache update policy or to configure additional (non-default) Quarkus extension registries.

=== Registry client configuration location

When the Quarkus dev tools are launched, a search for the registry client configuration file is performed following these steps:

. `quarkus.tools.config` system property is checked, if it exists, its value will be used as a path to the registry client configuration file;
. the current directory is checked to contain the `.quarkus/config.yaml` file, if the file exists, it will be used to configure the registry client;
. the user home directory is checked to contain the `~/.quarkus/config.yaml` file, if the file exists, it will be used to configure the registry client;
. if none of the above steps located a configuration file, the default <<registry.quarkus.io.maven.repo,registry.quarkus.io>> configuration will be used.

=== Configuring multiple registries

The <<registry.quarkus.io,registry.quarkus.io>> is the default Quarkus community extension registry, but it is not meant to be always the only registry. Other organizations may find it useful to create their own Quarkus extension registries to provide their own xref:platform.adoc[Quarkus platforms] and/or individual (non-platform) Quarkus extensions. Users wishing to enable custom Quarkus extension registries in their environment would need to add them to the registry client configuration file.

The registry client configuration file is a simple YAML file which contains a list of registries, for example:

[source,yaml]
----
registries:
- registry.acme.org
- registry.quarkus.io
----

The configuration above enables two registries: `registry.acme.org` and `registry.quarkus.io`. The order of the registries is actually significant. When the Quarkus dev tools are looking for extensions on user's request, the registries will be searched in the order they are configured, i.e. from the top to the bottom of the list. Extensions and platforms found first will appear as the preferred ones to the user.

IMPORTANT: <<registry.quarkus.io,registry.quarkus.io>> is the default registry which normally does not have to be configured explicitly, however if a user provides a custom registry list and `registry.quarkus.io` is not in it, <<registry.quarkus.io,registry.quarkus.io>> will *not* be enabled.

For example, here is a registry client configuration that replaces the default <<registry.quarkus.io,registry.quarkus.io>> registry with a custom one:

[source,yaml]
----
registries:
- registry.acme.org
----

=== Adjusting the registry cache update policy

Usually, a Quarkus extension registry will be implemented as a Maven snapshot repository. The platform and extension catalogs resolved from the registry as Maven artifacts will be cached in the user's local Maven repository. The platform and extension catalogs are actually `SNAPSHOT` artifacts that are periodically checked for updates by the registry client. The default registry interval to check for updates matches the default value of the Maven's `updatePolicy` for https://maven.apache.org/settings.html#repositories[snapshot repositories] and is `daily`. This default can be overridden in the registry configuration, for example:

[source,yaml]
----
registries:
- registry.acme.org:
    update-policy: "always"
- registry.quarkus.io
----

In the example above, the `registry.acme.org` registry will be checked for catalog updates on every catalog request, while the `registry.quarkus.io` registry will be checked for catalog updates once a day (on the first catalog request of the day).

Here is a complete list of choices for a registry's `update-policy` value:

* _always_ - check for the updates on every catalog request;
* _daily_ (default) - check for the catalog updates once a day on the first catalog request;
* _interval:X_ (where X is an integer in minutes) - custom interval in minutes;
* _never_ - resolve the catalogs once and never check for updates.

=== Disabling a registry in the configuration

All the registries listed in the configuration file are enabled by default. A registry can be disabled though by adding `enabled: false` to its configuration. For example:

[source,yaml]
----
registries:
- registry.acme.org
- registry.quarkus.io:
    enabled: false
----

In the configuration above, only the `registry.acme.org` is enabled. The configuration above is equivalent to:

[source,yaml]
----
registries:
- registry.acme.org
----

=== Enabling the debug mode

The registry client is not logging much information by default. However, it does resolve various artifacts from Maven repositories behind the scenes. If you would like to see artifact transfer and other debugging related messages in the logs, you can enable the debug mode in the configuration. For example:

[source,yaml]
----
debug: true
registries:
- registry.acme.org
- registry.quarkus.io
----
=== Overriding a registry URL

There may be situations where the URL of the registry changes, however the ID needs to be the same (because the Maven coordinates are queried). To override the registry URL, add the following:

[source,yaml]
----
registries:
- registry.acme.org
- registry.quarkus.io:
    maven:
      repository:
        url: https://internal.registry.acme.org/maven
----



=== [[how-to-register-as-nexus-repository]] How to register as a Nexus Repository proxy

You can register a Quarkus extension registry as a Nexus repository proxy.You need to be an administrator to perform these operations.

==== [[how-to-register-as-nexus-2-repository]] Nexus 2.x
Some options need to be set:

- Set the `Repository Policy` to `Snapshot`;
- Disable `Download Remote Indexes`;
- Disable `Allow File Browsing`;
- Disable `Include in Search`.

Here is an example on how it should look like:

[[img-nexus]]
.Nexus Repository Manager: Add Proxy Repository
image:registry-nexus-repository.png[Nexus Repository Proxy]

==== [[how-to-register-as-nexus-3-repository]] Nexus 3.x

- Create a `maven2(proxy)` repository
- Set the `Version Policy` to `Snapshot`
- Set the `Remote Storage` URL to `https://registry.quarkus.io/maven`

image:registry-nexus3-repository.png[Nexus Repository Proxy]
